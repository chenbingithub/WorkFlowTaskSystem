webpackJsonp([29],{290:function(e,t,n){"use strict";function r(e){d||n(900)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(515),a=n.n(s);for(var o in s)"default"!==o&&function(e){n.d(t,e,function(){return s[e]})}(o);var i=n(902),l=n.n(i),d=!1,c=n(3),p=r,u=c(a.a,l.a,!1,p,null,null);u.options.__file="src\\views\\baseInfo\\user.vue",t.default=u.exports},515:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(11),a=r(s),o=n(12),i=r(o),l=n(6);r(l);t.default={name:"access_index",data:function(){var e=this;return{editUser:{},selectUser:{},persBtn:{create:abp.auth.isGranted("Pages.Users.Create"),update:abp.auth.isGranted("Pages.Users.Update"),delete:abp.auth.isGranted("Pages.Users.Delete"),setOrgan:abp.auth.isGranted("Pages.Users.SetOrgan"),setRole:abp.auth.isGranted("Pages.Users.SetRole"),setPers:abp.auth.isGranted("Pages.Users.SetPers")},seachKey:"",showModal:!1,showEditModal:!1,newUserRule:{userName:[{required:!0,message:"账号是必填项",trigger:"blur"}],emailAddress:[{required:!0,message:"邮箱是必填项",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],name:[{required:!0,message:"姓名是必填项",trigger:"blur"}]},userRule:{userName:[{required:!0,message:"账号是必填项",trigger:"blur"}],emailAddress:[{required:!0,message:"邮箱是必填项",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],name:[{required:!0,message:"姓名是必填项",trigger:"blur"}]},columns:[{type:"index",width:60,align:"center"},{title:this.L("账号"),key:"userName"},{title:this.L("姓名"),key:"name"},{title:this.L("默认角色"),key:"roleNames"},{title:this.L("是否启用"),key:"isActive",width:100,render:function(e,t){return e("strong",t.row.isActive?"已启用":"未启用")}},{title:this.L("操作"),key:"action",width:150,render:function(t,n){var r=[];if(e.persBtn.update){var s=t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.editUser=e.users[n.index],e.$store.dispatch({type:"user/getuser",data:e.editUser.id}),e.showEditModal=!0}}},e.L("编辑"));r.push(s)}if(e.persBtn.delete){var o=t("Button",{props:{type:"error",size:"small"},on:{click:function(){function t(){return r.apply(this,arguments)}var r=(0,i.default)(a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$Modal.confirm({title:e.L(""),content:e.L("删除这个用户吗？"),okText:e.L("是"),cancelText:e.L("否"),onOk:function(){function t(){return r.apply(this,arguments)}var r=(0,i.default)(a.default.mark(function t(){return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch({type:"user/delete",data:e.users[n.index]});case 2:return e.$Message.success("删除成功！"),t.next=5,e.getpage();case 5:case"end":return t.stop()}},t,e)}));return t}()});case 1:case"end":return t.stop()}},t,e)}));return t}()}},e.L("删除"));r.push(o)}return t("div",r)}}]}},methods:{create:function(){this.editUser={isActive:!0},this.$store.dispatch({type:"user/getuser",data:"-1"}),this.showModal=!0},save:function(){function e(){return t.apply(this,arguments)}var t=(0,i.default)(a.default.mark(function e(){var t=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.editUser.id?this.$refs.userForm.validate(function(){var e=(0,i.default)(a.default.mark(function e(n){var r,s,o,i,l,d,c,p;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=23;break}return r=[],s=[],o=[],i=[],l=[],d=t.$refs.uroles.getCheckedNodes(),c=t.$refs.uorgan.getCheckedNodes(),p=t.$refs.upers.getCheckedNodes(),d.forEach(function(e,t,n){r.push(e.id),i.push(e.title)}),c.forEach(function(e,t,n){s.push(e.id),l.push(e.title)}),p.forEach(function(e,t,n){o.push(e.id)}),t.editUser.roleIds=r,t.editUser.organIds=s,t.editUser.persIds=o,t.editUser.roleNames=i.join(","),t.editUser.organizationUnitNames=l.join(","),e.next=19,t.$store.dispatch({type:"user/update",data:t.editUser});case 19:return t.showEditModal=!1,t.$Message.success("保存成功！"),e.next=23,t.getpage();case 23:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()):this.$refs.newUserForm.validate(function(){var e=(0,i.default)(a.default.mark(function e(n){var r,s,o,i,l,d,c,p;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=23;break}return r=[],s=[],o=[],i=[],l=[],d=t.$refs.croles.getCheckedNodes(),c=t.$refs.corgan.getCheckedNodes(),p=t.$refs.cpers.getCheckedNodes(),d.forEach(function(e,t,n){r.push(e.id),i.push(e.title)}),c.forEach(function(e,t,n){s.push(e.id),l.push(e.title)}),p.forEach(function(e,t,n){o.push(e.id)}),t.editUser.roleIds=r,t.editUser.organIds=s,t.editUser.persIds=o,t.editUser.roleNames=i.join(","),t.editUser.organizationUnitNames=l.join(","),e.next=19,t.$store.dispatch({type:"user/create",data:t.editUser});case 19:return t.showModal=!1,t.$Message.success("添加成功！"),e.next=23,t.getpage();case 23:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,this)}));return e}(),pageChange:function(e){this.$store.commit("user/setCurrentPage",e),this.getpage()},pagesizeChange:function(e){this.$store.commit("user/setPageSize",e),this.getpage()},seachKeyChange:function(){this.$store.commit("user/setSeachKey",this.seachKey),this.getpage()},getpage:function(){function e(){return t.apply(this,arguments)}var t=(0,i.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch({type:"user/getAll"});case 2:case"end":return e.stop()}},e,this)}));return e}(),handleClickActionsDropdown:function(e){"Create"===e?this.create():"Refresh"===e&&(this.getpage(),this.$Message.success("刷新成功！"))},onselectchange:function(e){this.selectUser=e.pop(),this.$store.commit("user/setOrganzitionId",this.selectUser.data.id),this.getpage()},getAllorganiztion:function(){function e(){return t.apply(this,arguments)}var t=(0,i.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch({type:"organization/getAll"});case 2:case"end":return e.stop()}},e,this)}));return e}()},computed:{organzitions:function(){return this.$store.state.organization.organizations},users:function(){return this.$store.state.user.users},totalCount:function(){return this.$store.state.user.totalCount},currentPage:function(){return this.$store.state.user.currentPage},pageSize:function(){return this.$store.state.user.pageSize},roles:function(){return this.$store.state.user.roles},pers:function(){return this.$store.state.user.pers},organ:function(){return this.$store.state.user.organ}},created:function(){function e(){return t.apply(this,arguments)}var t=(0,i.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.getpage(),this.getAllorganiztion();case 2:case"end":return e.stop()}},e,this)}));return e}()}},900:function(e,t,n){var r=n(901);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n(22)("1c54935e",r,!1)},901:function(e,t,n){t=e.exports=n(21)(!1),t.push([e.i,'\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n.form_table {\n  width: 100%;\n  table-layout: fixed;\n}\n.form_table th {\n  border: 1px solid #CCCCCC;\n  padding: 5px;\n  color: gray;\n  text-align: right;\n  /*background-color: #E0ECFF;*/\n  width: 180px;\n}\n.form_table td {\n  border: 1px solid #CCCCCC;\n  padding: 6px 0 5px 10px;\n  text-align: left;\n  color: #717171;\n  line-height: 200%;\n}\n.bg-light {\n  color: #58666e;\n  background-color: #edf1f2;\n}\n.wrapper-md {\n  padding: 20px;\n}\n.bg-light.lter,\n.bg-light .lter {\n  background-color: #f6f8f8;\n}\n.m-n {\n  margin: 0 !important;\n}\n.font-thin {\n  font-weight: 300;\n}\n.form_table1 {\n  width: 100%;\n  table-layout: fixed;\n}\n.padding10 {\n  padding: 10px !important;\n}\n.nobordertable,\n.hovertable {\n  margin-right: auto;\n  margin-left: auto;\n  width: 99%;\n}\n.nobordertable,\n.nobordertable tr {\n  font-family: "\\5B8B\\4F53";\n  font-size: 14px;\n  color: #000000;\n  border-collapse: collapse;\n}\n.nobordertable td {\n  font-family: "\\5B8B\\4F53";\n  font-size: 14px;\n  color: #045795;\n  padding-top: 10px;\n}\n.nobordertable .td1 {\n  text-align: right;\n  font-size: 12px;\n  color: #045795;\n  font-weight: bold;\n  width: 20%;\n}\n.nobordertable .td2 {\n  text-align: left;\n  font-size: 12px;\n  color: #222;\n  padding-left: 10px;\n}\n.hovertable,\n.hovertable tr,\n.hovertable td {\n  font-family: "\\5B8B\\4F53";\n  font-size: 14px;\n  color: #000000;\n  line-height: 30px;\n  border: 1px solid #ABCFF8;\n  border-collapse: collapse;\n}\n.hovertable .td1 {\n  text-align: right;\n  font-size: 12px;\n  color: #045795;\n  font-weight: bold;\n  width: 20%;\n}\n.hovertable .td2 {\n  text-align: left;\n  font-size: 12px;\n  color: #222;\n  padding-left: 10px;\n}\n.table_title {\n  font-weight: bold;\n  height: 32px;\n  line-height: 32px;\n  text-align: center;\n  padding-left: 10px;\n  color: #045795;\n  background-color: #e9f4fd;\n}\n.access-user-con {\n  height: 200px;\n}\n.access-current-user-con {\n  text-align: center;\n  padding-top: 10px;\n}\n.access-current-user-con img {\n  display: block;\n  width: 100px;\n  height: 100px;\n  border: 2px solid #dddde2;\n  border-radius: 50%;\n  margin: 0px auto 10px;\n}\n.access-current-user-con p {\n  display: block;\n  padding: 20px 0 0;\n}\n.access-current-user-con p b {\n  margin: 0 10px;\n  color: #2d8cf0;\n}\n.access-change-access-con-row {\n  height: 200px;\n}\n',""])},902:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e._f("l")("用户管理")))]),e._v(" "),n("Row",[n("Col",{attrs:{span:"5"}},[n("Card",{staticStyle:{"min-height":"400px"}},[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    组织部门\n                ")]),e._v(" "),n("Tree",{attrs:{data:e.organzitions},on:{"on-select-change":e.onselectchange}})],1)],1),e._v(" "),n("Col",{staticClass:"padding-left-10",attrs:{span:"19"}},[n("Card",{staticStyle:{"min-height":"400px"}},[n("p",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e._f("l")("用户信息")))]),e._v(" "),n("Dropdown",{attrs:{slot:"extra"},on:{"on-click":e.handleClickActionsDropdown},slot:"extra"},[n("a",{attrs:{href:"javascript:void(0)"}},[e._v("\n                "+e._s(e._f("l")("操作"))+"\n                "),n("Icon",{attrs:{type:"android-more-vertical"}})],1),e._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[n("DropdownItem",{attrs:{name:"Refresh"}},[e._v(e._s(e._f("l")("刷新")))]),e._v(" "),e.persBtn.create?n("DropdownItem",{attrs:{name:"Create"}},[e._v(e._s(e._f("l")("添加")))]):e._e()],1)],1),e._v(" "),n("Input",{on:{"on-enter":e.seachKeyChange},model:{value:e.seachKey,callback:function(t){e.seachKey=t},expression:"seachKey"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("关键字：")]),e._v(" "),n("Button",{attrs:{slot:"append",type:"info"},on:{click:e.seachKeyChange},slot:"append"},[e._v("搜索")])],1),e._v(" "),n("Table",{attrs:{columns:e.columns,border:"",data:e.users}}),e._v(" "),n("Page",{staticClass:"margin-top-10",attrs:{total:e.totalCount,"page-size":e.pageSize,current:e.currentPage,"show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":e.pageChange,"on-page-size-change":e.pagesizeChange}})],1),e._v(" "),n("Modal",{attrs:{title:e.L("添加"),okText:e.L("save"),cancelText:e.L("cancel")},on:{"on-ok":e.save},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("div",[n("Tabs",[n("TabPane",{attrs:{label:"用户信息",icon:"ios-list"}},[n("Form",{ref:"newUserForm",attrs:{"label-width":80,rules:e.newUserRule,model:e.editUser}},[n("FormItem",{attrs:{label:e.L("账号"),prop:"userName"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.userName,callback:function(t){e.$set(e.editUser,"userName",t)},expression:"editUser.userName"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("邮箱"),prop:"emailAddress"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.emailAddress,callback:function(t){e.$set(e.editUser,"emailAddress",t)},expression:"editUser.emailAddress"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("姓名"),prop:"name"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.name,callback:function(t){e.$set(e.editUser,"name",t)},expression:"editUser.name"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("电话"),prop:"phoneNumber"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.phoneNumber,callback:function(t){e.$set(e.editUser,"phoneNumber",t)},expression:"editUser.phoneNumber"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("描述"),prop:"description"}},[n("Input",{model:{value:e.editUser.description,callback:function(t){e.$set(e.editUser,"description",t)},expression:"editUser.description"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("是否启用"),prop:"isActive"}},[n("Checkbox",{model:{value:e.editUser.isActive,callback:function(t){e.$set(e.editUser,"isActive",t)},expression:"editUser.isActive"}},[e._v("启用")])],1)],1)],1),e._v(" "),e.persBtn.setOrgan?n("TabPane",{attrs:{label:"部门",icon:"network"}},[n("div",{staticStyle:{"max-height":"320px","overflow-y":"auto"}},[n("Tree",{ref:"corgan",attrs:{data:e.organ,"show-checkbox":"",multiple:""}})],1)]):e._e(),e._v(" "),e.persBtn.setRole?n("TabPane",{attrs:{label:"角色",icon:"ios-people"}},[n("div",{staticStyle:{"max-height":"320px","overflow-y":"auto"}},[n("Tree",{ref:"croles",attrs:{data:e.roles,"show-checkbox":"",multiple:""}})],1)]):e._e(),e._v(" "),e.persBtn.setPers?n("TabPane",{attrs:{label:"权限",icon:"gear-b"}},[n("div",{staticStyle:{"max-height":"320px","overflow-y":"auto"}},[n("Tree",{ref:"cpers",attrs:{data:e.pers,"show-checkbox":"",multiple:""}})],1)]):e._e()],1)],1),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:function(t){e.showModal=!1}}},[e._v(e._s(e._f("l")("取消")))]),e._v(" "),n("Button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e._f("l")("确定")))])],1)]),e._v(" "),n("Modal",{attrs:{title:e.L("编辑"),okText:e.L("save"),cancelText:e.L("cancel")},on:{"on-ok":e.save},model:{value:e.showEditModal,callback:function(t){e.showEditModal=t},expression:"showEditModal"}},[n("div",[n("Tabs",[n("TabPane",{attrs:{label:"用户信息",icon:"ios-list"}},[n("Form",{ref:"userForm",attrs:{"label-width":80,rules:e.userRule,model:e.editUser}},[n("FormItem",{attrs:{label:e.L("账号"),prop:"userName"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.userName,callback:function(t){e.$set(e.editUser,"userName",t)},expression:"editUser.userName"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("邮箱"),prop:"emailAddress"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.emailAddress,callback:function(t){e.$set(e.editUser,"emailAddress",t)},expression:"editUser.emailAddress"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("姓名"),prop:"name"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.name,callback:function(t){e.$set(e.editUser,"name",t)},expression:"editUser.name"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("电话"),prop:"phoneNumber"}},[n("Input",{attrs:{maxlength:32,minlength:2},model:{value:e.editUser.phoneNumber,callback:function(t){e.$set(e.editUser,"phoneNumber",t)},expression:"editUser.phoneNumber"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("描述"),prop:"description"}},[n("Input",{model:{value:e.editUser.description,callback:function(t){e.$set(e.editUser,"description",t)},expression:"editUser.description"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.L("是否启用"),prop:"isActive"}},[n("Checkbox",{model:{value:e.editUser.isActive,callback:function(t){e.$set(e.editUser,"isActive",t)},expression:"editUser.isActive"}},[e._v("启用")])],1)],1)],1),e._v(" "),e.persBtn.setOrgan?n("TabPane",{attrs:{label:"部门",icon:"network"}},[n("div",{staticStyle:{"max-height":"360px","overflow-y":"auto"}},[n("Tree",{ref:"uorgan",attrs:{data:e.organ,"show-checkbox":"",multiple:""}})],1)]):e._e(),e._v(" "),e.persBtn.setRole?n("TabPane",{attrs:{label:"角色",icon:"ios-people"}},[n("div",{staticStyle:{"max-height":"320px","overflow-y":"auto"}},[n("Tree",{ref:"uroles",attrs:{data:e.roles,"show-checkbox":"",multiple:""}})],1)]):e._e(),e._v(" "),e.persBtn.setPers?n("TabPane",{attrs:{label:"权限",icon:"gear-b"}},[n("div",{staticStyle:{"max-height":"320px","overflow-y":"auto"}},[n("Tree",{ref:"upers",attrs:{data:e.pers,"show-checkbox":"",multiple:""}})],1)]):e._e()],1)],1),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:function(t){e.showEditModal=!1}}},[e._v(e._s(e._f("l")("取消")))]),e._v(" "),n("Button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e._f("l")("确定")))])],1)])],1)],1)],1)],1)},s=[];r._withStripped=!0;var a={render:r,staticRenderFns:s};t.default=a}});